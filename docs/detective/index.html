<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Amazon Detective — detective • paws</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script href="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script href="../pkgdown.js"></script><meta property="og:title" content="Amazon Detective — detective"><meta property="og:description" content='Detective uses machine learning and purpose-built visualizations to help
you to analyze and investigate security issues across your Amazon Web
Services (Amazon Web Services) workloads. Detective automatically
extracts time-based events such as login attempts, API calls, and
network traffic from CloudTrail and Amazon Virtual Private Cloud (Amazon
VPC) flow logs. It also extracts findings detected by Amazon GuardDuty.
The Detective API primarily supports the creation and management of
behavior graphs. A behavior graph contains the extracted data from a set
of member accounts, and is created and managed by an administrator
account.
To add a member account to the behavior graph, the administrator account
sends an invitation to the account. When the account accepts the
invitation, it becomes a member account in the behavior graph.
Detective is also integrated with Organizations. The organization
management account designates the Detective administrator account for
the organization. That account becomes the administrator account for the
organization behavior graph. The Detective administrator account is also
the delegated administrator account for Detective in Organizations.
The Detective administrator account can enable any organization account
as a member account in the organization behavior graph. The organization
accounts do not receive invitations. The Detective administrator account
can also invite other accounts to the organization behavior graph.
Every behavior graph is specific to a Region. You can only use the API
to manage behavior graphs that belong to the Region that is associated
with the currently selected endpoint.
The administrator account for a behavior graph can use the Detective API
to do the following:
Enable and disable Detective. Enabling Detective creates a new
behavior graph.
View the list of member accounts in a behavior graph.
Add member accounts to a behavior graph.
Remove member accounts from a behavior graph.
Apply tags to a behavior graph.


The organization management account can use the Detective API to select
the delegated administrator for Detective.
The Detective administrator account for an organization can use the
Detective API to do the following:
Perform all of the functions of an administrator account.
Determine whether to automatically enable new organization accounts
as member accounts in the organization behavior graph.


An invited member account can use the Detective API to do the following:
View the list of behavior graphs that they are invited to.
Accept an invitation to contribute to a behavior graph.
Decline an invitation to contribute to a behavior graph.
Remove their account from a behavior graph.


All API actions are logged as CloudTrail events. See Logging Detective API Calls with CloudTrail.
We replaced the term "master account" with the term "administrator
account." An administrator account is used to centrally manage multiple
accounts. In the case of Detective, the administrator account manages
the accounts in their behavior graph.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="..">paws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
</li>
<li>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paws-r/paws/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Amazon Detective</h1>
    <small class="dont-index">Source: <a href="https://github.com/paws-r/paws/blob/HEAD/R/detective_service.R" class="external-link"><code>R/detective_service.R</code></a></small>
    <div class="hidden name"><code>detective.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Detective uses machine learning and purpose-built visualizations to help
you to analyze and investigate security issues across your Amazon Web
Services (Amazon Web Services) workloads. Detective automatically
extracts time-based events such as login attempts, API calls, and
network traffic from CloudTrail and Amazon Virtual Private Cloud (Amazon
VPC) flow logs. It also extracts findings detected by Amazon GuardDuty.</p>
<p>The Detective API primarily supports the creation and management of
behavior graphs. A behavior graph contains the extracted data from a set
of member accounts, and is created and managed by an administrator
account.</p>
<p>To add a member account to the behavior graph, the administrator account
sends an invitation to the account. When the account accepts the
invitation, it becomes a member account in the behavior graph.</p>
<p>Detective is also integrated with Organizations. The organization
management account designates the Detective administrator account for
the organization. That account becomes the administrator account for the
organization behavior graph. The Detective administrator account is also
the delegated administrator account for Detective in Organizations.</p>
<p>The Detective administrator account can enable any organization account
as a member account in the organization behavior graph. The organization
accounts do not receive invitations. The Detective administrator account
can also invite other accounts to the organization behavior graph.</p>
<p>Every behavior graph is specific to a Region. You can only use the API
to manage behavior graphs that belong to the Region that is associated
with the currently selected endpoint.</p>
<p>The administrator account for a behavior graph can use the Detective API
to do the following:</p><ul><li><p>Enable and disable Detective. Enabling Detective creates a new
behavior graph.</p></li>
<li><p>View the list of member accounts in a behavior graph.</p></li>
<li><p>Add member accounts to a behavior graph.</p></li>
<li><p>Remove member accounts from a behavior graph.</p></li>
<li><p>Apply tags to a behavior graph.</p></li>
</ul><p>The organization management account can use the Detective API to select
the delegated administrator for Detective.</p>
<p>The Detective administrator account for an organization can use the
Detective API to do the following:</p><ul><li><p>Perform all of the functions of an administrator account.</p></li>
<li><p>Determine whether to automatically enable new organization accounts
as member accounts in the organization behavior graph.</p></li>
</ul><p>An invited member account can use the Detective API to do the following:</p><ul><li><p>View the list of behavior graphs that they are invited to.</p></li>
<li><p>Accept an invitation to contribute to a behavior graph.</p></li>
<li><p>Decline an invitation to contribute to a behavior graph.</p></li>
<li><p>Remove their account from a behavior graph.</p></li>
</ul><p>All API actions are logged as CloudTrail events. See <a href="https://docs.aws.amazon.com/detective/latest/adminguide/logging-using-cloudtrail.html" class="external-link">Logging Detective API Calls with CloudTrail</a>.</p>
<p>We replaced the term "master account" with the term "administrator
account." An administrator account is used to centrally manage multiple
accounts. In the case of Detective, the administrator account manages
the accounts in their behavior graph.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detective</span><span class="op">(</span>config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>config</dt>
<dd><p>Optional configuration of credentials, endpoint, and/or region.</p><ul><li><p><strong>access_key_id</strong>: AWS access key ID</p></li>
<li><p><strong>secret_access_key</strong>: AWS secret access key</p></li>
<li><p><strong>session_token</strong>: AWS temporary session token</p></li>
<li><p><strong>profile</strong>: The name of a profile to use. If not given, then the default profile is used.</p></li>
<li><p><strong>anonymous</strong>: Set anonymous credentials.</p></li>
<li><p><strong>endpoint</strong>: The complete URL to use for the constructed client.</p></li>
<li><p><strong>region</strong>: The AWS Region used in instantiating the client.</p></li>
<li><p><strong>close_connection</strong>: Immediately close all HTTP connections.</p></li>
<li><p><strong>timeout</strong>: The time in seconds till a timeout exception is thrown when attempting to make a connection. The default is 60 seconds.</p></li>
<li><p><strong>s3_force_path_style</strong>: Set this to <code>true</code> to force the request to use path-style addressing, i.e., <code>http://s3.amazonaws.com/BUCKET/KEY</code>.</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A client for the service. You can call the service's operations using
syntax like <code>svc$operation(...)</code>, where <code>svc</code> is the name you've assigned
to the client. The available operations are listed in the
Operations section.</p>
    </div>
    <div id="service-syntax">
    <h2>Service syntax</h2>
    


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>svc <span class="ot">&lt;-</span> <span class="fu">detective</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">config =</span> <span class="fu">list</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">credentials =</span> <span class="fu">list</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">creds =</span> <span class="fu">list</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">access_key_id =</span> <span class="st">"string"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">secret_access_key =</span> <span class="st">"string"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">session_token =</span> <span class="st">"string"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">profile =</span> <span class="st">"string"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">anonymous =</span> <span class="st">"logical"</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">endpoint =</span> <span class="st">"string"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="st">"string"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">close_connection =</span> <span class="st">"logical"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">timeout =</span> <span class="st">"numeric"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">s3_force_path_style =</span> <span class="st">"logical"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre><p></p></div>
    </div>
    <div id="operations">
    <h2>Operations</h2>
    

<table class="table table"><tr><td><a href="accept_invitation.html">accept_invitation</a></td><td>Accepts an invitation for the member account to contribute data to a behavior graph</td></tr><tr><td><a href="batch_get_graph_member_datasources.html">batch_get_graph_member_datasources</a></td><td>Gets data source package information for the behavior graph</td></tr><tr><td><a href="batch_get_membership_datasources.html">batch_get_membership_datasources</a></td><td>Gets information on the data source package history for an account</td></tr><tr><td><a href="create_graph.html">create_graph</a></td><td>Creates a new behavior graph for the calling account, and sets that account as the administrator account</td></tr><tr><td><a href="create_members.html">create_members</a></td><td>CreateMembers is used to send invitations to accounts</td></tr><tr><td><a href="delete_graph.html">delete_graph</a></td><td>Disables the specified behavior graph and queues it to be deleted</td></tr><tr><td><a href="delete_members.html">delete_members</a></td><td>Removes the specified member accounts from the behavior graph</td></tr><tr><td><a href="describe_organization_configuration.html">describe_organization_configuration</a></td><td>Returns information about the configuration for the organization behavior graph</td></tr><tr><td><a href="disable_organization_admin_account.html">disable_organization_admin_account</a></td><td>Removes the Detective administrator account in the current Region</td></tr><tr><td><a href="disassociate_membership.html">disassociate_membership</a></td><td>Removes the member account from the specified behavior graph</td></tr><tr><td><a href="enable_organization_admin_account.html">enable_organization_admin_account</a></td><td>Designates the Detective administrator account for the organization in the current Region</td></tr><tr><td><a href="get_members.html">get_members</a></td><td>Returns the membership details for specified member accounts for a behavior graph</td></tr><tr><td><a href="list_datasource_packages.html">list_datasource_packages</a></td><td>Lists data source packages in the behavior graph</td></tr><tr><td><a href="list_graphs.html">list_graphs</a></td><td>Returns the list of behavior graphs that the calling account is an administrator account of</td></tr><tr><td><a href="list_invitations.html">list_invitations</a></td><td>Retrieves the list of open and accepted behavior graph invitations for the member account</td></tr><tr><td><a href="list_members.html">list_members</a></td><td>Retrieves the list of member accounts for a behavior graph</td></tr><tr><td><a href="list_organization_admin_accounts.html">list_organization_admin_accounts</a></td><td>Returns information about the Detective administrator account for an organization</td></tr><tr><td><a href="list_tags_for_resource.html">list_tags_for_resource</a></td><td>Returns the tag values that are assigned to a behavior graph</td></tr><tr><td><a href="reject_invitation.html">reject_invitation</a></td><td>Rejects an invitation to contribute the account data to a behavior graph</td></tr><tr><td><a href="start_monitoring_member.html">start_monitoring_member</a></td><td>Sends a request to enable data ingest for a member account that has a status of ACCEPTED_BUT_DISABLED</td></tr><tr><td><a href="tag_resource.html">tag_resource</a></td><td>Applies tag values to a behavior graph</td></tr><tr><td><a href="untag_resource.html">untag_resource</a></td><td>Removes tags from a behavior graph</td></tr><tr><td><a href="update_datasource_packages.html">update_datasource_packages</a></td><td>Starts a data source packages for the behavior graph</td></tr><tr><td><a href="update_organization_configuration.html">update_organization_configuration</a></td><td>Updates the configuration for the Organizations integration in the current Region</td></tr></table></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">svc</span> <span class="op">&lt;-</span> <span class="fu">detective</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">svc</span><span class="op">$</span><span class="fu">accept_invitation</span><span class="op">(</span></span>
<span>  Foo <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Kretch, Adam Banker, Dyfan Jones.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

