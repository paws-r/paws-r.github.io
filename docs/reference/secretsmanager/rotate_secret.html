<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Configures and starts the asynchronous process of rotating the secret — secretsmanager_rotate_secret • paws</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css"><script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet"><script src="../../pkgdown.js"></script><meta property="og:title" content="Configures and starts the asynchronous process of rotating the secret — secretsmanager_rotate_secret"><meta property="og:description" content="Configures and starts the asynchronous process of rotating the secret.
For more information about rotation, see Rotate secrets.
If you include the configuration parameters, the operation sets the
values for the secret and then immediately starts a rotation. If you
don't include the configuration parameters, the operation starts a
rotation with the values already stored in the secret.
For database credentials you want to rotate, for Secrets Manager to be
able to rotate the secret, you must make sure the secret value is in the
JSON structure of a database secret.
In particular, if you want to use the alternating users strategy,
your secret must contain the ARN of a superuser secret.
To configure rotation, you also need the ARN of an Amazon Web Services
Lambda function and the schedule for the rotation. The Lambda rotation
function creates a new version of the secret and creates or updates the
credentials on the database or service to match. After testing the new
credentials, the function marks the new secret version with the staging
label AWSCURRENT. Then anyone who retrieves the secret gets the new
version. For more information, see How rotation works.
You can create the Lambda rotation function based on the rotation function templates
that Secrets Manager provides. Choose a template that matches your
Rotation strategy.
When rotation is successful, the AWSPENDING staging label might be
attached to the same version as the AWSCURRENT version, or it might
not be attached to any version. If the AWSPENDING staging label is
present but not attached to the same version as AWSCURRENT, then any
later invocation of rotate_secret
assumes that a previous rotation request is still in progress and
returns an error.
Required permissions: secretsmanager:RotateSecret. For more
information, see IAM policy actions for Secrets Manager
and Authentication and access control in Secrets Manager.
You also need lambda:InvokeFunction permissions on the rotation
function. For more information, see Permissions for rotation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">paws</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paws-r/paws/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Configures and starts the asynchronous process of rotating the secret</h1>
    <small class="dont-index">Source: <a href="https://github.com/paws-r/paws/blob/HEAD/R/secretsmanager_operations.R" class="external-link"><code>R/secretsmanager_operations.R</code></a></small>
    <div class="hidden name"><code>secretsmanager_rotate_secret.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Configures and starts the asynchronous process of rotating the secret.
For more information about rotation, see <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html" class="external-link">Rotate secrets</a>.</p>
<p>If you include the configuration parameters, the operation sets the
values for the secret and then immediately starts a rotation. If you
don't include the configuration parameters, the operation starts a
rotation with the values already stored in the secret.</p>
<p>For database credentials you want to rotate, for Secrets Manager to be
able to rotate the secret, you must make sure the secret value is in the
<a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_secret_json_structure.html" class="external-link">JSON structure of a database secret</a>.
In particular, if you want to use the <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/getting-started.html#rotation-strategy" class="external-link">alternating users strategy</a>,
your secret must contain the ARN of a superuser secret.</p>
<p>To configure rotation, you also need the ARN of an Amazon Web Services
Lambda function and the schedule for the rotation. The Lambda rotation
function creates a new version of the secret and creates or updates the
credentials on the database or service to match. After testing the new
credentials, the function marks the new secret version with the staging
label <code>AWSCURRENT</code>. Then anyone who retrieves the secret gets the new
version. For more information, see <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html#rotate-secrets_how" class="external-link">How rotation works</a>.</p>
<p>You can create the Lambda rotation function based on the <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_available-rotation-templates.html" class="external-link">rotation function templates</a>
that Secrets Manager provides. Choose a template that matches your
<a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/getting-started.html#rotation-strategy" class="external-link">Rotation strategy</a>.</p>
<p>When rotation is successful, the <code>AWSPENDING</code> staging label might be
attached to the same version as the <code>AWSCURRENT</code> version, or it might
not be attached to any version. If the <code>AWSPENDING</code> staging label is
present but not attached to the same version as <code>AWSCURRENT</code>, then any
later invocation of <code>rotate_secret</code>
assumes that a previous rotation request is still in progress and
returns an error.</p>
<p><strong>Required permissions:</strong> <code>secretsmanager:RotateSecret</code>. For more
information, see <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_iam-permissions.html#reference_iam-permissions_actions" class="external-link">IAM policy actions for Secrets Manager</a>
and <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/auth-and-access.html" class="external-link">Authentication and access control in Secrets Manager</a>.
You also need <code>lambda:InvokeFunction</code> permissions on the rotation
function. For more information, see <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets-required-permissions-function.html" class="external-link">Permissions for rotation</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">secretsmanager_rotate_secret</span><span class="op">(</span><span class="va">SecretId</span>, <span class="va">ClientRequestToken</span>,</span>
<span>  <span class="va">RotationLambdaARN</span>, <span class="va">RotationRules</span>, <span class="va">RotateImmediately</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>SecretId</dt>
<dd><p>[required] The ARN or name of the secret to rotate.</p>
<p>For an ARN, we recommend that you specify a complete ARN rather than a
partial ARN. See <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/troubleshoot.html#ARN_secretnamehyphen" class="external-link">Finding a secret from a partial ARN</a>.</p></dd>


<dt>ClientRequestToken</dt>
<dd><p>A unique identifier for the new version of the secret that helps ensure
idempotency. Secrets Manager uses this value to prevent the accidental
creation of duplicate versions if there are failures and retries during
rotation. This value becomes the <code>VersionId</code> of the new version.</p>
<p>If you use the Amazon Web Services CLI or one of the Amazon Web Services
SDK to call this operation, then you can leave this parameter empty. The
CLI or SDK generates a random UUID for you and includes that in the
request for this parameter. If you don't use the SDK and instead
generate a raw HTTP request to the Secrets Manager service endpoint,
then you must generate a <code>ClientRequestToken</code> yourself for new versions
and include that value in the request.</p>
<p>You only need to specify this value if you implement your own retry
logic and you want to ensure that Secrets Manager doesn't attempt to
create a secret version twice. We recommend that you generate a
<a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" class="external-link">UUID-type</a>
value to ensure uniqueness within the specified secret.</p></dd>


<dt>RotationLambdaARN</dt>
<dd><p>The ARN of the Lambda rotation function that can rotate the secret.</p></dd>


<dt>RotationRules</dt>
<dd><p>A structure that defines the rotation configuration for this secret.</p></dd>


<dt>RotateImmediately</dt>
<dd><p>Specifies whether to rotate the secret immediately or wait until the
next scheduled rotation window. The rotation schedule is defined in
RotateSecretRequest$RotationRules.</p>
<p>If you don't immediately rotate the secret, Secrets Manager tests the
rotation configuration by running the <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html#rotate-secrets_how" class="external-link"><code>testSecret</code> step</a>
of the Lambda rotation function. The test creates an <code>AWSPENDING</code>
version of the secret and then removes it.</p>
<p>If you don't specify this value, then by default, Secrets Manager
rotates the secret immediately.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the following syntax:</p>


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ARN =</span> <span class="st">"string"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name =</span> <span class="st">"string"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VersionId =</span> <span class="st">"string"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre><p></p></div>


    </div>
    <div id="request-syntax">
    <h2>Request syntax</h2>
    


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>svc<span class="sc">$</span><span class="fu">rotate_secret</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">SecretId =</span> <span class="st">"string"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ClientRequestToken =</span> <span class="st">"string"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RotationLambdaARN =</span> <span class="st">"string"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">RotationRules =</span> <span class="fu">list</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">AutomaticallyAfterDays =</span> <span class="dv">123</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Duration =</span> <span class="st">"string"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ScheduleExpression =</span> <span class="st">"string"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">RotateImmediately =</span> <span class="cn">TRUE</span><span class="sc">|</span><span class="cn">FALSE</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre><p></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co"># The following example configures rotation for a secret using a cron</span></span>
<span><span class="co"># expression. The first rotation happens immediately after the changes are</span></span>
<span><span class="co"># stored in the secret. The rotation schedule is the first and 15th day of</span></span>
<span><span class="co"># every month. The rotation window begins at 4:00 PM UTC and ends at 6:00</span></span>
<span><span class="co"># PM.</span></span>
<span><span class="va">svc</span><span class="op">$</span><span class="fu">rotate_secret</span><span class="op">(</span></span>
<span>  RotationLambdaARN <span class="op">=</span> <span class="st">"arn:aws:lambda:us-west-2:123456789012:function:MyTes..."</span>,</span>
<span>  RotationRules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Duration <span class="op">=</span> <span class="st">"2h"</span>,</span>
<span>    ScheduleExpression <span class="op">=</span> <span class="st">"cron(0 16 1,15 * ? *)"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SecretId <span class="op">=</span> <span class="st">"MyTestDatabaseSecret"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following example requests an immediate invocation of the secret's</span></span>
<span><span class="co"># Lambda rotation function. It assumes that the specified secret already</span></span>
<span><span class="co"># has rotation configured. The rotation function runs asynchronously in</span></span>
<span><span class="co"># the background.</span></span>
<span><span class="va">svc</span><span class="op">$</span><span class="fu">rotate_secret</span><span class="op">(</span></span>
<span>  SecretId <span class="op">=</span> <span class="st">"MyTestDatabaseSecret"</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Kretch, Adam Banker, Dyfan Jones.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

